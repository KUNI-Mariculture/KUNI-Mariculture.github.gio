---
title: "Mariculture"
output:
  html_document:
    theme: united
    highlight: tango
    runtime: shiny
---

##Maping mariculture variables 2011

```{r, echo=FALSE, warning=FALSE}

setwd("~/KUNI/KUNI-Mariculture.github.io")

suppressPackageStartupMessages({
  library(readr)
  library(dplyr)
  library(tidyr)
  library(ggplot2)
  library(knitr)
  library(shiny)
  library(googleVis)

})

```

```{r echo = FALSE}
require(shiny)

mapa <- function(variable, FAO_Country, gTitle = "Mariculture 2011", var = "GDP"){
  require(shiny)
  
shinyApp(
  
  ui <- shinyUI(fluidPage(
  
  # Application title
  titlePanel(gTitle),
  
  # Show a plot of the generated distribution
  mainPanel(
    htmlOutput("gvis")
  )
)),


server <- shinyServer(function(input, output) {
  
  output$gvis=renderGvis({
    
    temp <- data.frame(data = variable, FAO_Country = FAO_Country) 
    # Plot countries
    
    gvisGeoChart(temp, "FAO_Country", "data", hovervar="FAO_Country",
                 options=list(gvis.editor=var, colorAxis="{colors:['#FFFFFF', '#0000FF']}"))
    
    
  })
}),


 options = list(height = 500)
)
} ## <- the function ends!!
```


```{r echo = FALSE, message=FALSE}

data1 <- read.csv('maps/data/data_normalized_092616.csv')
data2 <- read.csv('maps/data/CountryConversion.csv')
data3 <- merge(y = data1, x=data2, by.y = c("country"), by.x=c("FAO_Country"))

#gdp
data4 <- data3[!is.na(data3$gdp),]
mapa(variable = data4$gdp, FAO_Country = data4$FAO_Country, gTitle = "Mariculture 2011", var = "GDP")




```
