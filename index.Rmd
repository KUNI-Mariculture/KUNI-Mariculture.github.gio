---
title: "Mariculture"
output:
  html_document:
    theme: united
    highlight: tango
    runtime: shiny
---

##Maping mariculture variables 2011

```{r, echo=FALSE, warning=FALSE}
rm(list=ls())
setwd("~/KUNI/KUNI-Mariculture.github.io")

suppressPackageStartupMessages({
  library(readr)
  library(dplyr)
  library(tidyr)
  library(ggplot2)
  library(knitr)
  library(shiny)
  library(googleVis)

})

```

```{r echo = FALSE}
require(shiny)

mapa <- function(data1, FAO_Country, gTitle = "Mariculture 2011", variable = "GDP"){
  require(shiny)

shinyApp(

  ui <- shinyUI(fluidPage(

  # Application title
  titlePanel(gTitle),

  # Show a plot of the generated distribution
  mainPanel(
    htmlOutput("gvis")
  )
)),


server <- shinyServer(function(input, output) {

  output$gvis=renderGvis({

    temp <- data.frame(data = data1, FAO_Country = FAO_Country) 
    # Plot countries

    gvisGeoChart(temp, "FAO_Country", "data", hovervar="FAO_Country",
                 options=list(gvis.editor=variable, colorAxis="{colors:['#FFFFFF', '#0000FF']}"))


  })
}),


 options = list(height = 500)
)
} ## <- the function ends!!
```


```{r echo = FALSE, message=FALSE}

data1 <- read_csv('maps/data/data_normalized_092616.csv')
data2 <- read_csv('maps/data/CountryConversion.csv')
data3 <- merge(x = data1, y=data2, by.x = c("country"), by.y=c("FAO_Country"))
data3 <- data3[!is.na(data3$gdp),]

#gdp
gdp <- data3$gdp
FAO_Country <- data3$country

mapa(data1 = gdp, FAO_Country = FAO_Country, gTitle = "GDP")



```
